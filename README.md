# Comparison_interaction_networks
Here we compare three different methodologies (and use a fourth for reference) used to infer plant interaction networks for the bumblebee, _Bombus pascuorum_: transect interaction observations, gut DNA content, and corbicular pollen ball DNA content. Floral diversity survey data are also integrated into the analysis. Code and data are also prepared to support analyses of changes in genetic detections of interactions by varying factors such as site, period, and bee specimen size/gender.

# Data
We have two primary data sources used in this analysis: Interaction transect data (including B. pascuorum interactions and floral resource surveys) and B. pascuorum specimen data, including individual specifics (period, site, dimensions, sex) and sequencing data for ITS2 reads, processed using DADA2 (see repository for DADA2) and imported into R using phyloseq.


# Scripts
Data are generally prepared and processed in scripts according to their methodological origin (e.g. 01_interaction_data_2023.R, 03_gut_metabarcoding_data_2023.R, etc.), and then recalled in other scripts intended for comparative analyses (e.g. 05_methodology_comaprison_2023.R) or side analyses and cleaning (e.g. sed_db_genera_check.R). 

# Bioinformatics processing methods
Raw Illumina sequences are processed using the DADA2 bioinformatics pipeline (Callahan et al. 2016). Based on gut DNA sequence quality profiles, forward reads are trimmed at 240 base pairs and reverse reads at 210 bp. For consistency, all of the same parameters are used for pollen sequence bioinformatic processing. Maximum expected errors for forward reads are set to two, and a maximum of six is set for reverse reads. Minimum read overlap is set to 15 bp. In generating sequence tables, non-target-length sequences are filtered by removing sequences outside of the 240-450 bp range, and chimeras are removed using the default consensus method without pooling. Taxonomy is added to the ASVs using an existing reference sequence database (Bell 2021), which provides reference sequences at the species level for all but 21 of the species present in our study area, all of which were identifiable to the genus level in the database. This database allows for taxonomic assignment in two steps, using the assignTaxonomy() and addSpecies() functions of DADA2, although only identifications to the genus level are considered in our further analysis. Taxonomy iss classified using the pipeline’s internal method, “dada”, and a minimum bootstrap confidence of 50 is used for assigning taxonomic level.

We remove likely contaminants and misidentified ASVs from our bioinformatics results using a three-step screening process. First, ASV counts and taxonomy assigned in DADA2 are analyzed for contaminants using the decontam package in R (Davis et al. 2018). We use a prevalence test, in which gut sequence samples are compared to six negative sequenced controls, and pollen sequence samples are compared to one negative sequence control. We set a contaminant determination threshold of 0.5.  For pollen samples, the frequency test of decontam is also applied. Second, we conduct a BLAST search using ITS2 Database (Ankenbrand et al. 2015) to verify taxa that are identified by only one ASV within our results. ASVs corresponding to taxa that could be within the study area are kept, while the ASVs of unlikely taxa are removed. Finally, the remaining ASVs are screened by comparing the list of detected taxa to the list of documented plant species within the study area. This step is supervised by a local botanist, incorporating expert knowledge into the evaluation of our retained and discarded results.

